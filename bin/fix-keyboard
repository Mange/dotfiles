#!/bin/sh
config_dir="${XDG_CONFIG_HOME}/xmodmap"

xmodmap "${config_dir}/custom_keyboard"
programmable_keyboard=no

case "$(hostname)" in
  morbidus)
    programmable_keyboard=yes
    # Setup tablet, if plugged in
    if xinput list --name-only | grep -q "Wacom Intuos S"; then
      stylus="Wacom Intuos S Pen stylus"
      pad="Wacom Intuos S Pad pad"
      # Only draw on main screen
      xsetwacom set "$stylus" MapToOutput HEAD-0
      # Button 1: Undo
      xsetwacom set "$pad" Button 1 "key +ctrl z -ctrl"
    fi
    ;;
  bilquis)
    ;;
  *)
    # Do nothing extra
    ;;
esac

# Some keyboards cannot be reprogrammed in hardware.
if [ "$programmable_keyboard" = "no" ]; then
  xmodmap "${config_dir}/caps_is_super"
fi

# Make Super_L Escape when just quickly pressed
killall xcape 2>/dev/null; xcape -e 'Super_L=Escape'

# Faster key repeat rate
# 300ms until repeating, then 40 keys per second
xset r rate 300 40
