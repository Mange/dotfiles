#!/bin/sh
config_dir="${XDG_CONFIG_HOME}/xmodmap"

xmodmap "${config_dir}/custom_keyboard"
programmable_keyboard=no

case "$(hostname)" in
socia)
  programmable_keyboard=yes
  ;;
krista) ;;
*)
  # Do nothing extra
  ;;
esac

# Some keyboards cannot be reprogrammed in hardware.
if [ "$programmable_keyboard" = "no" ]; then
  xmodmap "${config_dir}/caps_is_super"
fi

# Make Super_L Escape when just quickly pressed
killall xcape 2>/dev/null
xcape -e 'Super_L=Escape'

# Faster key repeat rate
# 300ms until repeating, then 40 keys per second
xset r rate 300 40

setup_touchpad() {
  touchpad="$1"

  # Natural scrolling
  xinput set-prop "${touchpad}" "libinput Natural Scrolling Enabled" 1

  # Tapping
  xinput set-prop "${touchpad}" "libinput Tapping Enabled" 1

  # Disable touchpad while typing
  xinput set-prop "${touchpad}" "libinput Disable While Typing Enabled" 1
}

case "$(hostname)" in
krista)
  setup_touchpad "SynPS/2 Synaptics TouchPad"
  ;;

socia) ;;

*) ;;

esac

# In case my wacom tablet is plugged in, configure it
fix-wacom
