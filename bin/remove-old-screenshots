#!/usr/bin/env bash

dir="$HOME/Media/Pictures"
max_days=3

if [[ $1 == "--help" ]]; then
  cat <<-USAGE
Usage: $0 [--dry-run]

Will delete screenshots (in ${dir}) that are more than ${max_days} old.

--dry-run will only print the files that would be deleted instead of deleting
them.
USAGE
  exit 0
fi

if [[ $1 == "--dry-run" ]]; then
  shift
  commands=("du" "-h" "{}" ";")
else
  commands=("gio" "trash" "{}" ";")
fi

if [[ $# -gt 0 ]]; then
  echo "Unknown arguments: $*" >&2
  exit 1
fi

pattern='(Screenshot|Sk√§rmbild).*\.(png|jpg)'

fd "$pattern" \
  --max-depth 1 \
  --type file \
  --change-older-than "${max_days}days" \
  --exec-batch "${commands[@]}" \
  "$dir"
