#!/usr/bin/env bash
shopt -s nullglob

# shellcheck source=/dev/null
source "${XDG_CONFIG_HOME:-${HOME}/.config}/shells/common"

# shellcheck source=/dev/null
source "${XDG_CONFIG_HOME}/shells/enable-rvm"

# Tell KDE apps to load theme using qt5ct
export QT_QPA_PLATFORMTHEME=qt5ct

eval "$(/usr/bin/gnome-keyring-daemon --start --components=pkcs11,secrets,ssh)"
export SSH_AUTH_SOCK
export GNOME_KEYRING_CONTROL

# HiDPI
export QT_AUTO_SCREEN_SCALE_FACTOR=1

# For apps that cannot scale automatically, configure per-host
case "$(hostname --short)" in
bilquis)
  export GDK_SCALE=1
  ;;
*)
  export GDK_SCALE=1
  ;;
esac

# Try to fix the screen setup before starting i3
# This might help set sane defaults for programs starting up. Generally, I
# might have a single HiDPI display connected but it might be turned off. That
# does not mean that I want HiDPI on all other screens; I want it on no
# screens.
# Autorandr sets the DPI too, which should enable/disable autoscaling for
# some apps.
autorandr --change
