# vim: ft=sh
# Determine what shell is loading this script

# Shellcheck warns about the unnecessary "\"s in the code below, but they have
# an effect on some shells where ps could be an alias.
# shellcheck disable=SC1001
_shell_name=$(set +e; \command \ps -p $$ -o ucomm=)

# Use interactive, scripting-based RVM in Bash and ZSH
case "$_shell_name" in
  (*zsh|*bash)
    if [[ $_mange_rvm_enabled != "yes" ]]; then
      _mange_rvm_enabled="yes"
      if [[ -s /usr/share/rvm/scripts/rvm ]]; then
        # Arch-typical install directory
        # shellcheck source=/dev/null
        source /usr/share/rvm/scripts/rvm
      elif [[ -s /usr/local/rvm/scripts/rvm ]]; then
        # Debian-typical install directory
        # shellcheck source=/dev/null
        source /usr/local/rvm/scripts/rvm
      elif [[ -s "$HOME/.rvm/scripts/rvm" ]]; then
        # Manually per-user install directory
        # shellcheck source=/dev/null
        source "$HOME/.rvm/scripts/rvm"
      fi
    fi
    ;;
  (*)
    # In other shells (like sh, Xsession, etc.) then add the default
    # Ruby to the PATH if Ruby is not on PATH.
    if ! hash ruby 2>/dev/null; then
      if [[ -f "$HOME/.rvm/environments/default" ]]; then
        # shellcheck source=/dev/null
        source "$HOME/.rvm/environments/default"
      fi
    fi
esac

unset _shell_name
